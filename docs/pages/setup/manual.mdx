import { Steps } from "nextra/components";

# Manual Setup

If you don't want the `npx @convex/auth` command to make these changes for you,
or if it failed, follow these steps after you've installed the library.

<Steps>

### Configure private and public key

Run the following script via `node generateKeys.mjs`:

```js filename="generateKeys.mjs"
import { exportJWK, exportPKCS8, generateKeyPair } from "jose";

const keys = await generateKeyPair("RS256");
const privateKey = await exportPKCS8(keys.privateKey);
const publicKey = await exportJWK(keys.publicKey);
const jwks = JSON.stringify({ keys: [{ use: "sig", ...publicKey }] });

process.stdout.write(
  `JWT_PRIVATE_KEY="${privateKey.trimEnd().replace(/\n/g, " ")}"`,
);
process.stdout.write("\n");
process.stdout.write(`JWKS=${jwks}`);
process.stdout.write("\n");
```

Copy the whole output and paste it into your Convex dashboard deployment's
[Environment Variables](https://dashboard.convex.dev/deployment/settings/environment-variables)
page.

You should now have two variables set up: `JWT_PRIVATE_KEY` and `JWKS`.

### Configure `auth.config.ts`

```ts filename="convex/auth.config.ts"
export default {
  providers: [
    {
      domain: process.env.CONVEX_SITE_URL,
      applicationID: "convex",
    },
  ],
};
```

### Initialize `auth.ts`

```ts filename="convex/auth.ts"
import { convexAuth } from "@convex/auth";

export const { providers, signIn, signOut, verifyCode, store, auth } =
  convexAuth({
    providers: [],
  });
```

### Configure `http.ts`

```ts filename="convex/http.ts"
import { httpRouter } from "convex/server";
import { auth } from "./auth";

const http = httpRouter();

auth.addHttpRoutes(http);

export default http;
```

</Steps>
